$(document).ready(function(){var a=parseInt($("#container").css("width"));if($("#data").length>0){var b=.642*a,c=d3.geo.albers().scale(1.357*a).translate([a/2,b/2]),d=d3.geo.path().projection(c),e=d3.select("#geography").append("svg").style("width",a+"px").style("height",b+"px");d3.json("assets/data/combined.json",function(b,c){{var f=c.objects.states,g=c.objects.points;e.append("g").attr("class","states").selectAll("path").data(topojson.feature(c,f).features).enter().append("path").attr("class","state").attr("d",d),e.append("g").attr("class","lived").selectAll("path").data(topojson.feature(c,g).features).enter().append("path").attr("class","points").attr("d",d)}e.append("path").datum({type:"LineString",coordinates:[[-76.285,36.85],[-80.469,36.386],[-94.598,35.406],[-97.439,35.222]]}).attr("class","livedarc").attr("d",d).style("stroke-width",.005*a)});var f={top:20,bottom:30,left:40},g=.71*a-f.top-f.bottom,h=d3.scale.linear().range([0,a-50]),i=d3.scale.linear().range([g,0]),j=d3.scale.category20(),k=d3.svg.axis().scale(h).orient("bottom"),l=d3.svg.axis().scale(i).orient("left"),m=d3.select("#skills").append("svg").attr("width",a).attr("height",g+f.top+f.bottom).append("g").attr("transform","translate("+f.left+","+f.top+")");d3.tsv("assets/data/skills.tsv",function(b,c){c.forEach(function(a){a.level=+a.level,a.experience=+a.experience,a.use=+a.use}),h.domain(d3.extent(c,function(a){return a.experience})).nice(),i.domain(d3.extent(c,function(a){return a.level})).nice(),m.append("g").attr("class","x axis").attr("transform","translate(0,"+g+")").call(k).append("text").attr("class","label").attr("x",a-40).attr("y",-6).style("text-anchor","end").text("experience"),m.append("g").attr("class","y axis").call(l).append("text").attr("class","label").attr("transform","rotate(-90)").attr("y",6).attr("dy","0.71em").style("text-anchor","end").text("competency level"),m.selectAll(".dot").data(c).enter().append("circle").attr("class","dot").attr("r",function(a){return 3.4+.15*a.use}).attr("cx",function(a){return h(a.experience)}).attr("cy",function(a){return i(a.level)}).style("fill",function(a){return j(a.name)});var d=m.selectAll(".legend").data(j.domain()).enter().append("g").attr("class","legend").attr("transform",function(a,b){return"translate(-80,"+20*b+")"});d.append("rect").attr("x",a+5).attr("width",18).attr("height",18).style("fill",j).attr("margin-left","10px"),d.append("text").attr("x",a).attr("y",9).attr("dy",".35em").style("text-anchor","end").text(function(a){return a})});var n=d3.time.format("%d").parse,o=(d3.format(""),d3.format("%m"),{top2:10,right2:5,bottom2:20,left2:80}),p=500-o.top2-o.bottom2,q=d3.scale.ordinal().rangeRoundBands([p,0],.2),r=d3.scale.linear(),s=d3.scale.ordinal().rangeRoundBands([0,.9*a],.1,0),t=d3.nest().key(function(a){return a.group}),u=d3.layout.stack().values(function(a){return a.values}).x(function(a){return a.date}).y(function(a){return a.value}).out(function(a,b){a.valueOffset=b}),v=d3.scale.category20(),w=d3.select("#week").append("svg").attr("width",a).attr("height",p+o.top2+o.bottom2).append("g").attr("transform","translate("+o.left2+","+o.top2+")");w.append("text").attr("class","label").attr("x",.03*a).attr("y",473).style("text-anchor","start").text(function(){return"Sunday"}),w.append("text").attr("class","label").attr("x",.15*a).attr("y",473).style("text-anchor","start").text(function(){return"Monday"}),w.append("text").attr("class","label").attr("x",.28*a).attr("y",473).style("text-anchor","start").text(function(){return"Tuesday"}),w.append("text").attr("class","label").attr("x",.4*a).attr("y",473).style("text-anchor","start").text(function(){return"Wednesday"}),w.append("text").attr("class","label").attr("x",.54*a).attr("y",473).style("text-anchor","start").text(function(){return"Thursday"}),w.append("text").attr("class","label").attr("x",.68*a).attr("y",473).style("text-anchor","start").text(function(){return"Friday"}),w.append("text").attr("class","label").attr("x",.8*a).attr("y",473).style("text-anchor","start").text(function(){return"Saturday"}),d3.tsv("assets/data/weekgraph.tsv",function(a,b){function c(){clearTimeout(h),"multiples"===this.value?d():e()}function d(){var a=w.transition().duration(750),b=a.selectAll(".group").attr("transform",function(a){return"translate(0,"+q(a.key)+")"});b.selectAll("rect").attr("y",function(a){return r(a.value)}),b.select(".group-label1").attr("y",function(a){return r(a.values[0].value/2)})}function e(){var a=w.transition().duration(750),b=a.selectAll(".group").attr("transform","translate(0,"+q(q.domain()[0])+")");b.selectAll("rect").attr("y",function(a){return r(a.value+a.valueOffset)}),b.select(".group-label1").attr("y",function(a){return r(a.values[0].value/1+a.values[0].valueOffset)})}b.forEach(function(a){a.date=n(a.date),a.value=+a.value});var f=t.entries(b);u(f),s.domain(f[0].values.map(function(a){return a.date})),q.domain(f.map(function(a){return a.key})),r.domain([0,d3.max(b,function(a){return a.value})]).range([q.rangeBand(),0]);var g=w.selectAll(".group").data(f).enter().append("g").attr("class","group").attr("transform",function(a){return"translate(0,"+q(a.key)+")"});g.append("text").style("text-anchor","end").attr("class","group-label1").attr("x",-5).attr("y",function(a){return r(a.values[0].value/2)}).attr("dy",".35em").text(function(a){return 1==a.key?"cooking":2==a.key?"cycling":3==a.key?"work":4==a.key?"reading":5==a.key?"coding":6==a.key?"sleeping":"mystery"}),g.selectAll("rect").data(function(a){return a.values}).enter().append("rect").style("fill",function(a){return v(a.group)}).attr("x",function(a){return s(a.date)}).attr("y",function(a){return r(a.value)}).attr("width",s.rangeBand()).attr("height",function(a){return q.rangeBand()-r(a.value)}),g.filter(function(a,b){return!b}).append("g").attr("class","x axis").attr("transform","translate(0,"+q.rangeBand()+")"),d3.selectAll("input").on("change",c);var h=setTimeout(function(){d3.select('input[value="stacked"]').property("checked",!0).each(c)},15e3)}),$(window).resize(function(){a=parseInt($("#container").css("width")),b=.642*a,g=.71*a,c.translate([a/2,b/2]).scale(1.357*a),e.style("width",a+"px").style("height",b+"px"),e.selectAll(".state").attr("d",d),e.selectAll(".points").attr("d",d).style("stroke-width",1e-4*a),e.selectAll(".livedarc").attr("d",d).style("stroke-width",.005*a),$("#week svg").css("width",a).css("height",b),$("#skills svg").css("width",a).css("height",b)})}if($("#pienav").length>0){var x,b=Math.min(a,600),y=Math.min(a,b)/2,z=d3.svg.arc().outerRadius(y-10).innerRadius(0),A=d3.layout.pie().sort(null).value(function(a){return a.percent}),e=d3.select("#pienav").append("svg").style("width",a+"px").style("height",b+"px").append("g").attr("transform","translate("+a/2+","+b/2+")");d3.csv("assets/data/index.csv",function(a,b){x=e.selectAll(".arc").data(A(b)).enter().append("a").attr("xlink:href",function(a){return a.data.url}).append("g").attr("class","arc"),x.append("path").attr("d",z).attr("id",function(a){return a.data.id}).style("stroke","white"),x.append("text").attr("transform",function(a){return"translate("+z.centroid(a)+")"}).attr("dy",".35em").style("text-anchor","middle").text(function(a){return a.data.id})}),$(window).resize(function(){a=parseInt($("#container").css("width")),b=Math.min(a,600),y=Math.min(a,b)/2,d3.select("svg").style("width",a+"px").style("height",b+"px"),e.style("width",a+"px").style("height",b+"px").attr("transform","translate("+a/2+","+b/2+")"),z.outerRadius(y-10),x.selectAll("path").attr("d",z),x.selectAll("text").attr("transform",function(a){return"translate("+z.centroid(a)+")"})})}});